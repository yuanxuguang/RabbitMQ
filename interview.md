###  RabbitMQ如何保证消息的可靠传输性？

1. 持久化(Persistence): RabbitMQ 允许将队列、交换器和消息设置为持久化，这样即使 RabbitMQ 服务重启，这些数据也不会丢失。通过将 durable 参数在声明队列或交换器时设置为 true，可将队列和交换器设置为持久化。通过在发布消息前将 delivery_mode 设置为 2，可将消息设置为持久化。但需要注意的是，持久化数据会影响到 RabbitMQ 的性能。
2. 事务(Transaction): RabbitMQ 提供了事务机制，可以确保一次性发送或消费多个消息的完整性和一致性。当在事务中的操作发生错误时，你可以回滚事务，以撤销已执行的操作。事务通过 tx_select、tx_commit 和 tx_rollback 三个命令进行管理。然而，事务在 RabbitMQ 中的性能开销非常大，因此并不建议在需要高性能的系统中使用。
3. 发布者确认(Publisher Confirms): 这是 RabbitMQ 的一个特性，它允许你知道 RabbitMQ 已经接收到发布的消息。当 RabbitMQ 确认消息成功保存之后（例如，已经写入磁盘），它会发送一个确认给发布者。这样，即使 RabbitMQ 服务重启，消息也不会丢失。发布者确认的开销比事务小，因此是保证消息可靠性的一个好选择。
4. 消费者消息应答(Acknowledgment): 除了发布者确认，RabbitMQ 还有消费者确认机制。当一个消费者接收到消息后，它需要向 RabbitMQ 发送一个应答，告诉它已经接收并处理过这条消息了。这样 RabbitMQ 就可以从队列中删除这条消息。如果一个消费者没来得及处理完消息就宕机了，那么 RabbitMQ 会重新将这条消息发送给其他消费者进行处理。这保证了即使有消费者宕机，消息也不会丢失。